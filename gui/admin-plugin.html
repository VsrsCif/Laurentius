<div class ="sidebar" >    
    <h2>Kazalo:</h2>
    <ul >
        <li><a href="#/gui/Laurentius:application" >Aplikacija Laurentius</a>
            <ul style="padding-left: 23px">
                <li><a href="#gui/Laurentius:login"  >Prijavno okno</a></li> 
                <li><a href="#gui/Laurentius:workspace" >Delavno okolje</a></li> 
                <li><a href="#gui/Laurentius:tools" >Sklopi orodij</a></li> 
            </ul></li>
        <li><a href="#gui/admin-sed-box:admin" >Administracija: SED-predali</a>
            <ul style="padding-left: 23px">            
                <li><a href="#gui/admin-sed-box:add-edit" >Urejanje SED-predala</a></li> 
                <li><a href="#gui/admin-sed-box:export" >Izvoz dohodne pošte</a></li> 
                <li><a href="#gui/admin-sed-box:execute" >Izvajanje procesov</a></li> 

            </ul>
        <li><a href="#gui/admin-sed-user" >Administracija: Uporabniki</a>
            <ul style="padding-left: 23px">            
                <li><a href="#gui/admin-sed-user:user" >Seznam uporabnikov</a></li> 
                <li><a href="#gui/admin-sed-user:add-edit" >Urejanje uporabnika</a></li> 
            </ul>
        </li>
        <li><a href="#gui/admin-plugin" >Administracija: Certifikati</a>
            <ul style="padding-left: 23px">            
                <li><a href="#gui/admin-plugin:list" >Seznam shramb</a></li> 
                <li><a href="#gui/admin-plugin:add-edit" >Urejanje shrambe</a></li> 
            </ul>
        </li>
        <li><a href="#gui/admin-sed-tasks" >Administracija opravil</a>
            <ul style="padding-left: 23px">            
                <li><a href="#gui/admin-sed-tasks:list" >Seznam tipov opravil</a></li> 
                <li><a href="#gui/admin-sed-tasks:add-edit" >Dodajanje, urejanje tipa opravila</a></li> 
                <li><a href="#gui/admin-sed-tasks:cron-add-edit" >Dodajanje, urejanje urnika opravil</a></li> 
                <li><a href="#gui/task-backup:backup" >Opravilo: varnostna kopija</a></li> 
                <li><a href="#gui/task-archive:archive" >Opravilo: arhiv</a></li> 
                <li><a href="#gui/task-report:report" >Opravilo: poročilo</a></li> 
                <li><a href="#gui/task-zpp:zpp-plugin" >Opravilo: Vročanje ZPP</a></li> 
                <li><a href="#gui/task-filesubmitter" >Opravilo: Pošiljanje datotek</a></li>  

            </ul>
        </li>
        <li><a href="#gui/admin-plugin" >Administracija dodatkov</a>
            <ul style="padding-left: 23px">            
                <li><a href="#gui/admin-plugin:list" >Seznam dodatkov</a></li> 
                <li><a href="#gui/admin-plugin:add-edit" >Dodajanje, urejanje dodatka</a></li> 

            </ul>
        </li>
        
        <li><a href="#pmode/pmode" >Administracija: PMODE</a></li>
    </ul>
</div>
<div class="main">
    <article class='content'>
       <h1 id="gui/admin-plugin:admin">Administracija dodatkov (plugins)</h1>
       Administracija <b>dodatkov</b> (se nahaja v sklopu orodij <b>Nastavitve</b>
       (Settings) orodje Dodatki (Certificates). Orodje omogoča urejanje in dodajanje
       novih dodatkov.
       Dodatki omogočajo avtomatizacijo opravil pri sprejemu/pošiljanju sporočil pri posameznih vrstah storitev.
       Arhitektura tako omogoča poljubno dodajanje kode pri avtomatizaciji obdelave, preverjanju, ..., storitev. Kot primer je 
       dodan dodatek "ZPP", ki v celoti skrbi za vročanje pošiljko kot določa koreografija SVEV 2.0. Izhodni pošiljki tako doda 
       obvestilo o prispeli pošijki in šifrira vse priponke.  Na strani prejemnika pošiljke avtomatsko dešifrira 
       ob prejemu šifrirnega ključa. <br /><br />
       
       Dodatki so v aplikacijo sklopljeni preko EJB 3.0+ tehnologije in morajo biti nameščeni v <code>deployment</code>
       mapo aplikacijskega strežnika. Dodatki morajo implementirati  vmesnike:
       <ul>
           <li><b>PluginDescriptionInterface.java</b>: vmesnik določa tip, naziv, opis, ter jndi naslove ostalih storitev dodatka</li>
           <li><b>SoapInterceptorInterface.java</b>: vmesnik določa omogoča obdelavo vhodnega/izhodnega sporočila. Implementacija 
               ebMS 3.0 protokola uporablja  <b>apache-cxf</b> tehnologijo. Prestrežnik <i>(interceptor)</i> za izhodno pošto 
               se proži v fazi <b>Phase.USER_LOGICAL</b>. (Glej dokumentacijo: <i>apache-cxf bus</i>) za dohodno pošto pa v fazi <b>Phase.PRE_INVOKE</b>
               Dodatki tako implementirajo vmesnik dvakrat: enega za prestrezanje vhodnih sporočil in enega za prestrezanje izhodnih sporočil. 
               Uporaba "prestreznika" se določi v konfiguraciji pmode v elementu: <i>BusinessInfo/Service</i> v lastnostih:
               <i>Service/@inPlugin</i> in <i>Service/@outPlugin</i>
               <pre><code>&lt;BusinessInfo>
    &lt;Service 
        inPlugin="Laurentius-zpp-plugin-1.0.jar!si.jrc.msh.plugin.zpp.ZPPInInterceptor" 
        outPlugin="Laurentius-zpp-plugin-1.0.jar!si.jrc.msh.plugin.zpp.ZPPOutInterceptor"
    >LegalDelivery_ZPP&lt;/Service>
    ...
&lt;/BusinessInfo>
            </code></pre>
           </li>
       </ul>
       
       
       <h2 id="gui/admin-plugin:list">Seznam dodatkov</h2>
       Orodje <b>Dodatki</b> prikazujejo seznam registriranih dodatkov.<br />
       V orodni vrstici seznama so gumbi za dodajanje spreminjanje in brisanje dodatkov.<br /><br />
       <img src="img/gui/plugin_list.png" alt="Plugin admin" width="680"/> <br />
       <br />
       
       Ob kliki na gumb <b>Dodaj</b>(add),  <b>Uredi</b>(Edit) ali dvojnem kliku na izbrano 
       vstico se prikaže dialog za dodajanje/urejanje dodatkov.<br /><br />
       <center>
        <img src="img/gui/plugin_edit.png" alt="Plugin admin" width="400"/> <br />
       </center><br />
       <h2 id="gui/admin-plugin:add-edit">Dodajanje, urejanje dodatkov</h2>      
       
       Arhitektura omogoča poljubno izdelavo dodatkov, ki se jih namesti v deploy mapo aplikacijskega strežnika.
        V dialogu za urejanje dodatka je potrebno navesti <b>JNDI (EJB naslov)</b> do EJB instance opisa dodatka. Npr:
        <code>java:global/plugin-zpp/ZPPPluginDescription!si.sed.commons.interfaces.PluginDescriptionInterface</code>.
        Nato se klikom na gumb <i>Osveži (Refresh)</i>  preveri dostop do dodatka ter se osvežijo podatki:
        <ul>
            <li><b>Oznaka (Type)</b> je enolična oznaka dodatka</li>
            <li><b>Naziv (Name)</b> naziv dodatka. </li>
            <li><b>Spletni naslov (web context)</b> spletni naslov za urejanje nastavitve dodatka</li>
            <li><b>In-JNDI (In JNDI)</b> EJB naslov za prestreznik vhodne pošte</li>       
            <li><b>Out-JNDI (Out JNDI)</b> EJB naslov za prestreznik izhodne pošte</li>       
            <li><b>JNDI opravil (Tasks JNDI)</b> EJB naslovi za tipe opravil. Ob kliki na gumb potrdi se opravila dodajo 
            v seznam tipov opravil.</li>       
            <li><b>Opis (Description)</b> Opis dodatka</li>       
        </ul>

       <h2 id="gui/admin-plugin:desc-interface">Vmesnik: PluginDescriptionInterface</h2>    
       
       <pre><code>@Local
public interface PluginDescriptionInterface {
    
     String getSettingUrlContext();
     List&lt;String> getTaskJNDIs();
     String getJNDIOutInterceptor();
     String getJNDIInInterceptor();
     String getType();
     String getName();
     String getDesc();
}           
</code></pre>
       
<h2 id="gui/admin-plugin:interceptor-interface">Vmesnik: SoapInterceptorInterface</h2>      
       <pre><code>@Local
public interface SoapInterceptorInterface {
    
    public void handleMessage(SoapMessage t) throws Fault;
    public void handleFault(SoapMessage t);
}     
</code></pre>
       
    </article>  
</div>