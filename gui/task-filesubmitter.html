<div class="main">
    <article class='content'>

        <h2 id="gui/task-filesubmitter">Opravilo: Pošiljanje datotek </h2>
        Opravilo "Pošiljanje datotek" je namenjen pošiljanju sporočil iz map. 
        Poleg časa izvajanja je opravilu treba določiti parametre:
        <ul>
            <li><b>Mapa varnostne kopije: (file.submit.folder)</b>. Mapa, iz katere se pošilja sporočila določimo kot absolutno pot oz. z uporabo sistemskih spremenljivke: c:\archive\ ali ${sed.home}\archive. </li>
            <li><b>service</b>: Privzeta storitev pošiljanja pošiljk</li>
            <li><b>action</b>: Privzeta akcija v kateri se pošiljko pošilja.</li>
            <li><b>receiverBox</b>: Privzeti naslovnikov predal.</li>
            <li><b>senderBox</b>: Privzeti pošiljateljev  predal.</li>
        </ul>


        Privzete vrednosti: <b>service</b>,<b>action</b>,<b>receiverBox</b>,<b>senderBox</b> se upoštevajo v primeru, 
        da se ne določijo v metapodatkih posamezne pošiljke.<br /><br />
        Primer nastavitve:
         <img class="img-locale" src="img/gui/cron-task-FS-en.png" alt="cron task" width="680"/> <br />
        Vse pošiljke, ki se oddajo v mapo za pošiljanje:<code>${laurentius.home}/submit/dwr/</code>
        imajo prizete nastavitve:
        <ul>
            <li>Storitev: DeliveryWithReceipt</li>
            <li>Akcija: Delivery</li>
            <li>Predal pošiljatelja: b.department <i>(Lokalne domene ni potrebno izpisati. V primeru, da je lokalna domena test-laurentius.si, lahko vnesemo b.department@test-laurentius.si)</i></li>
        </ul>
        <h2 id="gui/task-filesubmitter:mail">Priprava pošiljk </h2>
        Pošiljke pripravimo tako, da v mapo za pošiljanje posnamemo priponke, ki jih želimo poslati in datoteko z metapodatki o pošiljki.
        <br /><br />Ime datoteke z metapodatki se mora pričeti z <b>outmail</b> ter kočnati z <b>.txt</b>.<br />
        Primeri datotek:<code>outmail-DWR-001.txt,outmail-DWR-002.txt, outmail-ZPP_12456.txt, , outmail-posebna-posiljka.txt,...</code>

        Datoteka z metapodati ima po vrsticah vsebovane podatke:
        <ul>
            <li><b>payload</b>: Seznam relativnih poti do priponk, ki se pošiljajo v pošiljki. Priponke so ločene z znakom: ';'. <b>Parameter je obvezen</b>  </li>
            <li><b>senderMessageId</b>: Id pošiljke pošiljatelja. Namen parametra je preprečevanje podvojenega pošiljanja pošiljk. V primeru, da je bila pošiljka s to vrednostjo
                že oddana v pošiljanje, pošiljka preide v staus napaka!</li>
            <li><b>service</b>: Storitev pošiljanja pošiljk. V primeru, da podatek ni podan se prevzame privzeta vrednost. </li>
            <li><b>action</b>: Akcija, v kateri se pošiljko pošilja. V primeru, da podatek ni podan se prevzame privzeta vrednost.</li>
            <li><b>receiverEBox</b>: Naslovnikov predal.  V primeru, da podatek ni podan se prevzame privzeta vrednost.</li>
            <li><b>senderEBox</b>: Pošiljateljev predal.  V primeru, da podatek ni podan se prevzame privzeta vrednost.</li>
        </ul>
        <br /><br />
        <h3>Primeri datotek:</h3>
        Pošiljanje sporočila s priponkami: test-1.pdf;test-2.pdf za lokalnega naslovnika: a.department. Enolična oznaka pošiljke je 001.
        Za storitev, akcija in pošiljateljev predal se uporabijo privzete vrednosti opravila.
        <br />Datoteka: <code>outmail-DWR-001.txt</code><br />
        <pre><code>
senderMessageId=001
receiverEBox=a.department
payload=test-1.pdf;test-2.pdf
        </code></pre><br />
        Pošiljanje sporočila s priponko: test-1.pdf za naslovnika: izvrzba@court-laurentius.si s storitvijo "DeliveryWithReceipt" in akcijo: "Delivery".         
        Enolična oznaka pošiljke je 002.
        <br />Datoteka: <code>outmail-DWR-002.txt</code><br />
        <pre><code>
senderMessageId=002
receiverEBox=izvrzba@court-laurentius.si
senderEBox=a.department
service=DeliveryWithReceipt
action=Delivery
payload=test-1.pdf
        </code></pre><br />

        Pošiljanje sporočila s priponkami: test-1.pdf;test-2.pdf;test-3.pdf brez kontrole pošiljanja pošiljke (senderMessageId). 
        Za storitev, akcija, naslovnikov predal in pošiljateljev predal se uporabijo privzete vrednosti opravila.
        <br />Datoteka: <code>outmail-DWR-003.txt</code><br />
        <pre><code>
payload=test-1.pdf;test-2.pdf;test-3.pdf
        </code></pre><br />


        <h2 id="gui/task-filesubmitter:process">Proces pošiljanja</h2>
        Ob proženju opravila se v mapi preveri za datoteke, ki se pričnejo z <code>outmail*.txt</code>.
        Za vsako datoteko se pred pričetkom pošiljanja pripravi <i>statusna datoteka</i>, ki je sestavljena:
        <code>[ime datoteke].(process|error|submitted)</code>. V primeru, da pošiljka že ima statusno 
        datoteko se pošiljka ignorira.<br /><br />
        Statusi:   

        <ul>
            <li><b>process</b>.  Pošiljka je v fazi priprave za pošiljanje. Datoteka vsebuje čas pričetka obdelave</li>
            <li><b>error</b>. Pri pripravi na pošijanje je prišlo do napake. V datoteki je izpisana napaka. Pošiljko se ponovno pošlje tako, da se statusna datoteka izbriše</li>
            <li><b>submitted</b>. Pošiljka je uspešno oddana v odpravo. Datoteka vsebuje datum oddaje v odpremo. Nadaljne statuse se lahko spremlja preko aplikacije laurentius</li>
        </ul>

        Ponovno pošiljanje pošiljk se proži tako, da se statusna pošiljka izbriše.








    </article>  
</div>